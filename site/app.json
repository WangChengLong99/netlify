[{"name": "app.py", "content": "ZnJvbSBzaGlueSBpbXBvcnQgQXBwLCByZW5kZXIsIHVpLCByZWFjdGl2ZQppbXBvcnQgcGFuZGFzIGFzIHBkCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgbWljcm9waXAKbWljcm9waXAuaW5zdGFsbCgibWF0cGxvdGxpYiIpCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKcGx0LnJjUGFyYW1zWydmb250LnNhbnMtc2VyaWYnXT1bJ1NpbWhlaSddOyAjU2ltSGVp6buR5L2TIApwbHQucmNQYXJhbXNbJ2F4ZXMudW5pY29kZV9taW51cyddPUZhbHNlOyAj5q2j5bi45pi+56S65Zu+5Lit6LSf5Y+3CgpzdHlsZXMgPSB7CiAgICAidGFibGVfY29udGFpbmVyX2RpdiIgOiAib3ZlcmZsb3cteDogYXV0bztvdmVyZmxvdy15OiBzY3JvbGw7bWF4LWhlaWdodDp7fXB4O21pbi13aWR0aDoxMDAlOyIsIAogICAgInRhYmxlIiA6ICJib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlO21pbi13aWR0aDoxMDAlO3RhYmxlLWxheW91dDogZml4ZWQ7IiwgICAgCiAgICAidGgiIDogImJvcmRlcjogMXB4IHNvbGlkICNkZGQ7cGFkZGluZzogOHB4O3RleHQtYWxpZ246IGxlZnQ7d2hpdGUtc3BhY2U6IG5vd3JhcDtvdmVyZmxvdzogaGlkZGVuO3RleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyAgYmFja2dyb3VuZC1jb2xvcjogI2YyZjJmMjt0b3A6IDA7ei1pbmRleDogMTsiLAogICAgInRkIiA6ICJib3JkZXI6IDFweCBzb2xpZCAjZGRkO3BhZGRpbmc6OHB4O3RleHQtYWxpZ246IGxlZnQ7d2hpdGUtc3BhY2U6IG5vd3JhcDtvdmVyZmxvdzogaGlkZGVuO3RleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyIsCiAgICAidWlfbm9sYWJlbF90ZCIgOiAiYm9yZGVyOiAxcHggc29saWQgI2RkZDtkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjNweDtoZWlnaHQ6NDFweDt3aGl0ZS1zcGFjZTogbm93cmFwO21pbl93aWR0aDoxMDBweDsiLAogICAgInVpX2NvbnRhaW5lcl90ZCIgOiAiYm9yZGVyOiAxcHggc29saWQgI2RkZDtkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjNweDttYXgtaGVpZ2h0OjcwcHg7d2hpdGUtc3BhY2U6IG5vd3JhcDttaW5fd2lkdGg6MTAwcHg7IiwKICAgICJidXR0b24iIDogImJhY2tncm91bmQtY29sb3I6cmdiKDEyMSwgMTg4LCAyMjkpO2NvbG9yOndoaXRlOyIKfQoKZGVmIGRmX3RvX3VpX3RhYmxlKGRmLGhlaWdodCxpbmRleF9jb249RmFsc2UpOgogICAgcmV0dXJuIHVpLmRpdigKICAgICAgICAgICAgdWkudGFncy50YWJsZSgKICAgICAgICAgICAgICAgIHVpLnRhZ3MudGhlYWQoCiAgICAgICAgICAgICAgICAgICAgdWkudGFncy50cigKICAgICAgICAgICAgICAgICAgICAgICAgKlt1aS50YWdzLnRoKGksc3R5bGU9c3R5bGVzWyJ0aCJdKSBmb3IgaSBpbiBsaXN0KGRmLmluZGV4Lm5hbWVzIGlmIGluZGV4X2NvbiBlbHNlIFtdKStsaXN0KGRmLmNvbHVtbnMpXSkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB1aS50YWdzLnRib2R5KAogICAgICAgICAgICAgICAgICAgICpbdWkudGFncy50cigqW3VpLnRhZ3MudGQoc3RyKGopLHN0eWxlPXN0eWxlc1sidGQiXSkgZm9yIGogaW4gKGxpc3QoaSBpZiBpc2luc3RhbmNlKGksdHVwbGUpIGVsc2UgW2ldKSBpZiBpbmRleF9jb24gZWxzZSBbXSkrZGYubG9jW2ksOl0udG9fbGlzdCgpXSkgZm9yIGkgaW4gZGYuaW5kZXhdCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc3R5bGUgPSBzdHlsZXNbInRhYmxlIl0KICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgIHN0eWxlID0gc3R5bGVzWyJ0YWJsZV9jb250YWluZXJfZGl2Il0uZm9ybWF0KGhlaWdodCkgICAKICAgICAgICApCgpkZWYgZGF0YV9zdW1tYXJ5KGRhdGEpOgogICAgZGVmIOe8uuWkseWAvCh4KToKICAgICAgICByZXR1cm4geC5pc251bGwoKS5zdW0oKQogICAgZGVmIOe8uuWkseavlOS+iyh5KToKICAgICAgICByZXR1cm4gZiJ7cm91bmQoeS5pc251bGwoKS5zdW0oKS9sZW4oeSksMikqMTAwfSUiCiAgICBkZWYg5pWw5o2u57G75Z6LKHopOgogICAgICAgIHJldHVybiB6LmR0eXBlcwogICAgZGYxID0gcGQuRGF0YUZyYW1lKFtbIuihjOaVsCIsZGF0YS5zaGFwZVswXV0sWyLliJfmlbAiLGRhdGEuc2hhcGVbMV1dLFsn6YeN5aSN5pWwJyxkYXRhLmR1cGxpY2F0ZWQoKS5zdW0oKV1dKQogICAgZGYgPSBkYXRhLmFnZyhb57y65aSx5YC8LOe8uuWkseavlOS+iyzmlbDmja7nsbvlnotdKS5ULnJlc2V0X2luZGV4KG5hbWVzPSLlrZfmrrUiKQogICAgc3VtbWFyeV9pbmZvID0gdWkuZGl2KAogICAgICAgICAgICAgICAgICAgICAgICB1aS50YWdzLnRhYmxlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKlt1aS50YWdzLnRyKCpbdWkudGFncy50ZChzdHIoaiksc3R5bGU9c3R5bGVzWyJ0ZCJdKSBmb3IgaiBpbiBkZjEubG9jW2ksOl1dKSBmb3IgaSBpbiBkZjEuaW5kZXhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSBzdHlsZXNbInRhYmxlIl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gc3R5bGVzWyJ0YWJsZV9jb250YWluZXJfZGl2Il0uZm9ybWF0KDEzMCkKICAgICAgICAgICAgICAgICkKICAgIHJldHVybiB1aS5kaXYoc3VtbWFyeV9pbmZvLGRmX3RvX3VpX3RhYmxlKGRmLDM1MCkpCgpkZWYgdWlfdGFibGUoY29sX251bSxoZWlnaHQ9MzAwLCp0YWdjaGlsZCk6CiAgICByb3csbW9kID0gZGl2bW9kKGxlbih0YWdjaGlsZCksY29sX251bSkKICAgIHJldHVybiB1aS5kaXYoCiAgICAgICAgICAgICAgICB1aS50YWdzLnRhYmxlKAogICAgICAgICAgICAgICAgICAgICpbdWkudGFncy50cih1aS50YWdzLnRkKHRhZ2NoaWxkWzIqcl1bMF0sdGFnY2hpbGRbMipyXVsxXSxzdHlsZT1zdHlsZXNbInVpX2NvbnRhaW5lcl90ZCJdKSx1aS50YWdzLnRkKHRhZ2NoaWxkWzIqcisxXVswXSx0YWdjaGlsZFsyKnIrMV1bMV0sc3R5bGU9c3R5bGVzWyJ1aV9jb250YWluZXJfdGQiXSkpIGZvciByIGluIHJhbmdlKHJvdyldLAogICAgICAgICAgICAgICAgICAgIHVpLnRhZ3MudHIoKlt1aS50YWdzLnRkKHVbMF0sdVsxXSxzdHlsZT1zdHlsZXNbInVpX2NvbnRhaW5lcl90ZCJdKSBmb3IgdSBpbiB0YWdjaGlsZFstbW9kOl1dKSBpZiBtb2QgPiAwIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICAgICBzdHlsZSA9IHN0eWxlc1sidGFibGUiXQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzdHlsZSA9IHN0eWxlc1sidGFibGVfY29udGFpbmVyX2RpdiJdLmZvcm1hdChoZWlnaHQpCiAgICAgICAgICAgICksCgpkaW1lbnNpb25fZGVzY3JpYmVfaGVpZ2h0ID0gMzAwCmRpbWVuc2lvbl92YWx1ZV9jb3VudF9oZWlnaHQgPSAyMDAKdmFsdWVfZGVzY3JpYmVfaGVpZ2h0ID0gMjAwCnZhbHVlX3Bsb3RfaGVpZ2h0ID0gIjIwMHB4IgoKYXBwX3VpID0gdWkucGFnZV9mbHVpZCgKICAgIHVpLnJvdygKICAgICAgICB1aS5jb2x1bW4oCiAgICAgICAgICAgIDQsCiAgICAgICAgICAgIHVpLm5hdnNldF90YWJfY2FyZCgKICAgICAgICAgICAgICAgIHVpLm5hdigKICAgICAgICAgICAgICAgICAgICAi5pWw5o2u5rqQIiwKICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dF9maWxlKCJkYXRhIiwi5a+85YWl5pWw5o2uIixhY2NlcHQ9WyIuY3N2IiwiLnhsc3giXSxwbGFjZWhvbGRlcj0i6YCJ5oupY3N25oiWZXhjZWzmlofku7YiLG11bHRpcGxlPVRydWUpLAogICAgICAgICAgICAgICAgICAgIHVpLm5hdnNldF90YWIoCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLm5hdigi5oC75L2TIix1aS5vdXRwdXRfdWkoImluZm9fcG9wIikpLAogICAgICAgICAgICAgICAgICAgICAgICB1aS5uYXYoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAi57u05bqmIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm91dHB1dF91aSgiZGltZW5zaW9uIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5vdXRwdXRfdWkoImluZm9fZGltZW5zaW9uIikpLAogICAgICAgICAgICAgICAgICAgICAgICB1aS5uYXYoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAi5bqm6YePIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm91dHB1dF91aSgidmFsdWUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm91dHB1dF91aSgiaW5mb192YWx1ZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkub3V0cHV0X3Bsb3QoInBsb3RfdmFsdWUiLGhlaWdodD12YWx1ZV9wbG90X2hlaWdodCkpLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHVpLm5hdigKICAgICAgICAgICAgICAgICAgICAi5pWw5o2u5riF5rSXIiwKICAgICAgICAgICAgICAgICAgICB1aS5jb2x1bW4oCiAgICAgICAgICAgICAgICAgICAgICAgIDEyLAogICAgICAgICAgICAgICAgICAgICAgICB1aS5uYXZzZXRfdGFiKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkubmF2KCLnsbvlnovovazmjaIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLmNvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEyLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm91dHB1dF91aSgiZmllbGRfZHR5cGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X2FjdGlvbl9idXR0b24oImNoYW5nZWR0eXBlIiwi5pS55Y+Y57G75Z6LIixzdHlsZT1zdHlsZXNbImJ1dHRvbiJdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gImhlaWdodDo2MDBweCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkubmF2KCLnvLrlpLHlgLzlpITnkIYiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLmNvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkub3V0cHV0X3VpKCJmaWVsZF9uYSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAiaGVpZ2h0OjYwMHB4IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKSwgICAgICAgCiAgICAgICAgICAgICksCiAgICAgICAgKSwKICAgICAgICB1aS5jb2x1bW4oCiAgICAgICAgICAgIDgsCiAgICAgICAgICAgIHVpLnJvdygKICAgICAgICAgICAgICAgIHVpLmNvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgNSwKICAgICAgICAgICAgICAgICAgICAgICAgdWkub3V0cHV0X3VpKCJjcmVhdGVfZ3JhcGhfdWkiKSwKICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAiaGVpZ2h0OjMxMHB4IgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHVpLmNvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgNywKICAgICAgICAgICAgICAgICAgICAgICAgdWkub3V0cHV0X3Bsb3QoInNob3dfZ3JhcGgiKSwKICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAiaGVpZ2h0OjMxMHB4IgogICAgICAgICAgICAgICAgKQogICAgKSwKICAgICAgICAgICAgdWkucm93KAogICAgICAgICAgICAgICAgdWkubmF2c2V0X3RhYl9jYXJkKAogICAgICAgICAgICAgICAgICAgIHVpLm5hdigi5pWw5o2uIix1aS5vdXRwdXRfdWkoInNob3dfZGF0YSIpKSwKICAgICAgICAgICAgICAgICAgICB1aS5uYXYoIuihqOi/nuaOpSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnJvdygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5jb2x1bW4oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkub3V0cHV0X3VpKCJjcmVhdGVfbWVyZ2VfdWkiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gImhlaWdodDozNTBweCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLmNvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5vdXRwdXRfdWkoInNob3dfbWVyZ2VfZGF0YSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAiaGVpZ2h0OjM1MHB4IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgdWkubmF2KCLpgI/op4booagiLAogICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5yb3coCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuY29sdW1uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm91dHB1dF91aSgiY3JlYXRlX3Bpdm90X3VpIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZSA9ICJoZWlnaHQ6MzUwcHgiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5jb2x1bW4oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA3LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkub3V0cHV0X3VpKCJzaG93X3Bpdm90X2RhdGEiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gImhlaWdodDozNTBweCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB1aS5uYXYoImdyb3VwYnkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5yb3coCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuY29sdW1uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm91dHB1dF91aSgiY3JlYXRlX2dyb3VwYnlfdWkiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gImhlaWdodDozNTBweCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLmNvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5vdXRwdXRfdWkoInNob3dfZ3JvdXBieV9kYXRhIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZSA9ICJoZWlnaHQ6MzUwcHgiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICApICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICkgICAgICAgIAopCgpkZWYgc2VydmVyKGlucHV0LG91dHB1dCxzZXNzaW9uKToKICAgIG1lcmdlX2RhdGEgPSByZWFjdGl2ZS5WYWx1ZSh7fSkKICAgIHBpdm90X2RhdGEgPSByZWFjdGl2ZS5WYWx1ZSh7fSkKICAgIGdyb3VwYnlfZGF0YSA9IHJlYWN0aXZlLlZhbHVlKHt9KQoKICAgICMjIyMjIyMjIyMjIyMjIyMjICDmlbDmja7lr7zlhaXlkYjnjrDmqKHlnZcgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMjIOWvvOWFpeaVsOaNru+8jOaVsOaNruS/neaMgeS4umNhbGPnirbmgIEs6L+U5Zue5pWw5o2u5Li6bmFtZTpkYXRh55qE5a2X5YW45b2i5byPCiAgICBAcmVhY3RpdmUuQ2FsYwogICAgZGVmIGdldF9kYXRhKCk6CiAgICAgICAgaWYgaW5wdXQuZGF0YSgpOgogICAgICAgICAgICBuYW1lX2RhdGEgPSB7aVsibmFtZSJdLnJlcGxhY2UoIi5jc3YiLCIiKSBpZiBpWyJuYW1lIl0uZW5kc3dpdGgoIi5jc3YiKSBlbHNlIGlbIm5hbWUiXS5yZXBsYWNlKCIueGxzeCIsIiIpIDogcGQucmVhZF9jc3YoaVsiZGF0YXBhdGgiXSkgaWYgaVsibmFtZSJdLmVuZHN3aXRoKCIuY3N2IikgZWxzZSBwZC5yZWFkX2V4Y2VsKGlbImRhdGFwYXRoIl0pIGZvciBpIGluIGlucHV0LmRhdGEoKX0KICAgICAgICAgICAgcmV0dXJuIG5hbWVfZGF0YQoKICAgICMjIOiOt+WPluW9k+WJjeagh+etvumhteaVsOaNriAgICAKICAgIEByZWFjdGl2ZS5DYWxjCiAgICBkZWYgc2VsZWN0ZWRfZGF0YSgpOgogICAgICAgIGlmIGlucHV0LmRhdGEoKToKICAgICAgICAgICAgaWYgaW5wdXQuZGF0YW5hbWUoKSBpbiBnZXRfZGF0YSgpLmtleXMoKToKICAgICAgICAgICAgICAgIHJldHVybiBnZXRfZGF0YSgpW2lucHV0LmRhdGFuYW1lKCldCgogICAgIyMg5Lul5qCH562+6aG15bGV56S65omA5pyJ5pWw5o2uCiAgICBAb3V0cHV0CiAgICBAcmVuZGVyLnVpCiAgICBkZWYgc2hvd19kYXRhKCk6CiAgICAgICAgaWYgaW5wdXQuZGF0YSgpOgogICAgICAgICAgICBkcyA9IGdldF9kYXRhKCkKICAgICAgICAgICAgcmV0dXJuIHVpLm5hdnNldF90YWIoCiAgICAgICAgICAgICAgICAgICAgKlt1aS5uYXYoayxkZl90b191aV90YWJsZSh2LmhlYWQoMTAwKSwzMDApKSBmb3Igayx2IGluIGRzLml0ZW1zKCldLAogICAgICAgICAgICAgICAgICAgIGlkPSJkYXRhbmFtZSIKICAgICAgICAgICAgICAgICkKCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIOaVsOaNruS/oeaBr+WRiOeOsCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyMg5bGV56S65rGH5oC75L+h5oGvCiAgICBAb3V0cHV0CiAgICBAcmVuZGVyLnVpCiAgICBkZWYgaW5mb19wb3AoKToKICAgICAgICBpZiBpc2luc3RhbmNlKHNlbGVjdGVkX2RhdGEoKSwgcGQuRGF0YUZyYW1lKToKICAgICAgICAgICAgcmV0dXJuIGRhdGFfc3VtbWFyeShzZWxlY3RlZF9kYXRhKCkpCiAgICAKICAgICMjIOe7tOW6puWtl+autQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIGRpbWVuc2lvbigpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VsZWN0ZWRfZGF0YSgpLCBwZC5EYXRhRnJhbWUpOgogICAgICAgICAgICByZXR1cm4gdWkuaW5wdXRfc2VsZWN0aXplKCJkbSIsIuW6pumHjyIsY2hvaWNlcz1saXN0KHNlbGVjdGVkX2RhdGEoKS5zZWxlY3RfZHR5cGVzKGV4Y2x1ZGU9WyJudW1iZXIiXSkuY29sdW1ucykpCiAgICAKICAgICMjIOWxleekuue7tOW6puS/oeaBrwogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIGluZm9fZGltZW5zaW9uKCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxlY3RlZF9kYXRhKCksIHBkLkRhdGFGcmFtZSk6CiAgICAgICAgICAgIGlmIChib29sKGlucHV0LmRtKCkpKSYoaW5wdXQuZG0oKSBpbiBzZWxlY3RlZF9kYXRhKCkuY29sdW1ucyk6CiAgICAgICAgICAgICAgICBkYXRhID0gc2VsZWN0ZWRfZGF0YSgpW1tpbnB1dC5kbSgpXV0KICAgICAgICAgICAgICAgIHJldHVybiB1aS5kaXYoCiAgICAgICAgICAgICAgICAgICAgZGF0YS5kZXNjcmliZSgpLnJlc2V0X2luZGV4KG5hbWVzPSLmjIfmoIciKS5waXBlKGRmX3RvX3VpX3RhYmxlLGRpbWVuc2lvbl9kZXNjcmliZV9oZWlnaHQpLAogICAgICAgICAgICAgICAgICAgIGRhdGEudmFsdWVfY291bnRzKCkudG9fZnJhbWUoKS5yZXNldF9pbmRleChuYW1lcz0i5Y+W5YC8IikucGlwZShkZl90b191aV90YWJsZSxkaW1lbnNpb25fdmFsdWVfY291bnRfaGVpZ2h0KSkgCgogICAgIyMg5bqm6YeP5a2X5q61CiAgICBAb3V0cHV0CiAgICBAcmVuZGVyLnVpCiAgICBkZWYgdmFsdWUoKToKICAgICAgICBpZiBpc2luc3RhbmNlKHNlbGVjdGVkX2RhdGEoKSwgcGQuRGF0YUZyYW1lKToKICAgICAgICAgICAgcmV0dXJuIHVpLmlucHV0X3NlbGVjdGl6ZSgidmwiLCLluqbph48iLGNob2ljZXM9bGlzdChzZWxlY3RlZF9kYXRhKCkuc2VsZWN0X2R0eXBlcyhpbmNsdWRlPVsibnVtYmVyIl0pLmNvbHVtbnMpKQogICAgCiAgICAjIyDlsZXnpLrluqbph4/kv6Hmga8KICAgIEBvdXRwdXQKICAgIEByZW5kZXIudWkKICAgIGRlZiBpbmZvX3ZhbHVlKCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxlY3RlZF9kYXRhKCksIHBkLkRhdGFGcmFtZSk6CiAgICAgICAgICAgIGlmIChib29sKGlucHV0LnZsKCkpKSYoaW5wdXQudmwoKSBpbiBzZWxlY3RlZF9kYXRhKCkuY29sdW1ucyk6CiAgICAgICAgICAgICAgICBkYXRhID0gc2VsZWN0ZWRfZGF0YSgpW1tpbnB1dC52bCgpXV0KICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmRlc2NyaWJlKCkucmVzZXRfaW5kZXgobmFtZXM9IuaMh+aghyIpLnBpcGUoZGZfdG9fdWlfdGFibGUsdmFsdWVfZGVzY3JpYmVfaGVpZ2h0KQoKICAgICMjIOWxleekuuW6pumHj+WIhuW4gwogICAgQG91dHB1dAogICAgQHJlbmRlci5wbG90CiAgICBkZWYgcGxvdF92YWx1ZSgpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VsZWN0ZWRfZGF0YSgpLCBwZC5EYXRhRnJhbWUpOgogICAgICAgICAgICBpZiAoYm9vbChpbnB1dC52bCgpKSkmKGlucHV0LnZsKCkgaW4gc2VsZWN0ZWRfZGF0YSgpLmNvbHVtbnMpOgogICAgICAgICAgICAgICAgZGF0YSA9IHNlbGVjdGVkX2RhdGEoKVtpbnB1dC52bCgpXQogICAgICAgICAgICAgICAgZmlnLGF4ID0gcGx0LnN1YnBsb3RzKDEsMSkKICAgICAgICAgICAgICAgIGF4Lmhpc3QoCiAgICAgICAgICAgICAgICB4PWRhdGEsCiAgICAgICAgICAgICAgICAjI+euseWtkOaVsChiaW5zKeiuvue9ru+8jOS7peS4i+S4ieenjeS4jeiDveWQjOaXtuW5tuWtmAogICAgICAgICAgICAgICAgI2JpbnM9MjAsI2RlZmF1bHQ6IDEwCiAgICAgICAgICAgICAgICAjYmlucz1bNCw2LDhdLCPliIbkuKTkuKrnrrHlrZDvvIzovrnnlYzliIbliKvkuLpbNCw2KSxbNiw4XQogICAgICAgICAgICAgICAgYmlucz0nYXV0bycsIyDlj6/pgIknYXV0bycsICdmZCcsICdkb2FuZScsICdzY290dCcsICdzdG9uZScsICdyaWNlJywgJ3N0dXJnZXMnLCBvciAnc3FydCcuCiAgICAgICAgICAgICAgICAj6YCJ5oup5pyA5ZCI6YCC55qEYmlu5a6977yM57uY5Yi25LiA5Liq5pyA6IO95Y+N5pig5pWw5o2u6aKR546H5YiG5biD55qE55u05pa55Zu+IAoKICAgICAgICAgICAgICAgICNyYW5nZT0oNSw3KSwj5pyA5bem6L655ZKM5pyA5Y+z6L65566x5a2Q6L6555WM77yM5LiN5oyH5a6a5pe277yM5Li6KHgubWluKCksIHgubWF4KCkpCiAgICAgICAgICAgICAgICBkZW5zaXR5PVRydWUsICPpu5jorqTkuLpGYWxzZe+8jHnovbTmmL7npLrpopHmlbDvvJvkuLpUcnVlIHnovbTmmL7npLrpopHnjofvvIzpopHnjofnu5/orqHnu5Pmnpw96K+l5Yy66Ze06aKR5pWwLyh45Lit5oC75qC35pys5pWwKuivpeWMuumXtOWuveW6pikKICAgICAgICAgICAgICAgICN3ZWlnaHRzPW5wLnJhbmRvbS5yYW5kKGxlbih4KSksI+WvuXjkuK3mr4/kuIDkuKrmoLfmnKzorr7nva7mnYPph43vvIzov5nph4zpmo/mnLrorr7nva7kuobmnYPph40KICAgICAgICAgICAgICAgIGN1bXVsYXRpdmU9RmFsc2UsI+m7mOiupEZhbHNl77yM5piv5ZCm57Sv5Yqg6aKR5pWw5oiW6ICF6aKR546H77yM5Y+K5ZCO6Z2i5LiA5Liq5p+x5a2Q5piv5YmN6Z2i5omA5pyJ5p+x5a2Q55qE57Sv5YqgCiAgICAgICAgICAgICAgICBib3R0b209MCwj6K6+572u566x5a2Qeei9tOaWueWQkeWfuue6v++8jOm7mOiupOS4ujDvvIznrrHlrZDpq5jluqY9Ym90dG9tIHRvIGJvdHRvbSArIGhpc3QoeCwgYmlucykKICAgICAgICAgICAgICAgIGhpc3R0eXBlPSdiYXInLCPnm7Tmlrnlm77nmoTnsbvlnovpu5jorqTkuLpiYXJ7J2JhcicsICdiYXJzdGFja2VkJywgJ3N0ZXAnLCAnc3RlcGZpbGxlZCd9CiAgICAgICAgICAgICAgICBhbGlnbj0nbWlkJywj566x5a2Q6L6555WM5YC855qE5a+56b2Q5pa55byP77yM6buY6K6k5Li6bWlkeydsZWZ0JywgJ21pZCcsICdyaWdodCd9CiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0ndmVydGljYWwnLCPnrrHlrZDmsLTlubPov5jmmK/lnoLnm7TmmL7npLrvvIzpu5jorqTlnoLnm7TmmL7npLooJ3ZlcnRpY2FsJynvvIzlj6/pgIknaG9yaXpvbnRhbCcKICAgICAgICAgICAgICAgIHJ3aWR0aD0xLjAsI+avj+S4queuseWtkOWuveW6pu+8jOm7mOiupOS4ujHvvIzmraTml7bmmL7npLo1MCUKICAgICAgICAgICAgICAgIGxvZz1GYWxzZSwjeei9tOaVsOaNruaYr+WQpuWPluWvueaVsO+8jOm7mOiupOS4jeWPluWvueaVsOS4ukZhbHNlCiAgICAgICAgICAgICAgICBsYWJlbD1pbnB1dC52bCgpLCPlm77kvosKICAgICAgICAgICAgICAgICNub3JtZWQ9MCwj5Yqf6IO95ZKMZGVuc2l0eeS4gOagt++8jOS6jOiAheS4jeiDveWQjOaXtuS9v+eUqAogICAgICAgICAgICAgICAgZmFjZWNvbG9yPSdibHVlJywj566x5a2Q6aKc6ImyIAogICAgICAgICAgICAgICAgZWRnZWNvbG9yPSJibGFjayIsI+euseWtkOi+ueahhuminOiJsgogICAgICAgICAgICAgICAgc3RhY2tlZD1GYWxzZSwj5aSa57uE5pWw5o2u5piv5ZCm5aCG5Y+gCiAgICAgICAgICAgICAgICBhbHBoYT0wLjUj566x5a2Q6YCP5piO5bqmCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICByZXR1cm4gZmlnCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIOaVsOaNrua4hea0lyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMg5bGV56S65pWw5o2u57G75Z6L5bm25LiU5Y+v5pu05pS5CiAgICBAb3V0cHV0CiAgICBAcmVuZGVyLnVpCiAgICBkZWYgZmllbGRfZHR5cGUoKToKICAgICAgICBpZiBpc2luc3RhbmNlKHNlbGVjdGVkX2RhdGEoKSwgcGQuRGF0YUZyYW1lKToKICAgICAgICAgICAgZDEgPSBzZWxlY3RlZF9kYXRhKCkuZHR5cGVzLnJlc2V0X2luZGV4KCkKICAgICAgICAgICAgZDEuY29sdW1ucyA9IFsi5a2X5q61Iiwi5pWw5o2u57G75Z6LIl0KICAgICAgICAgICAgZHR5cGVfaW5mbyA9IHVpLmRpdigKICAgICAgICAgICAgdWkudGFncy50YWJsZSgKICAgICAgICAgICAgICAgIHVpLnRhZ3MudGhlYWQoCiAgICAgICAgICAgICAgICAgICAgdWkudGFncy50cigKICAgICAgICAgICAgICAgICAgICAgICAgdWkudGFncy50aCgi5a2X5q61IixzdHlsZT1zdHlsZXNbInRoIl0pLAogICAgICAgICAgICAgICAgICAgICAgICB1aS50YWdzLnRoKCLmlbDmja7nsbvlnosiLHN0eWxlPXN0eWxlc1sidGgiXSsid2lkdGg6MTAwcHg7Iikj5ZKM5LiL6Z2i55qEdWnnmoR3aWR0aOS/neaMgeS4gOiHtOOAggogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgdWkudGFncy50Ym9keSgKICAgICAgICAgICAgICAgICpbdWkudGFncy50cigKICAgICAgICAgICAgICAgICAgICB1aS50YWdzLnRkKGQxLmxvY1tpLCLlrZfmrrUiXSxzdHlsZT1zdHlsZXNbInRkIl0pLAogICAgICAgICAgICAgICAgICAgIHVpLnRhZ3MudGQodWkuaW5wdXRfc2VsZWN0aXplKGQxLmxvY1tpLCLlrZfmrrUiXSsiZHR5cGUiLE5vbmUsY2hvaWNlcz1bImludDMyIiwiaW50NjQiLCJudW1iZXIiLCJvYmplY3QiLCJzdHJpbmciLCJib29sIiwiZGF0ZXRpbWU2NCIsImZsb2F0NjQiXSxzZWxlY3RlZD1kMS5sb2NbaSwi5pWw5o2u57G75Z6LIl0sd2lkdGg9IjEwMHB4Iiksc3R5bGU9c3R5bGVzWyJ1aV9ub2xhYmVsX3RkIl0pCiAgICAgICAgICAgICAgICAgICAgKSBmb3IgaSBpbiBkMS5pbmRleF0sCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHN0eWxlID0gc3R5bGVzWyJ0YWJsZSJdCiAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzdHlsZSA9IHN0eWxlc1sidGFibGVfY29udGFpbmVyX2RpdiJdLmZvcm1hdCg1NTApCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmV0dXJuIGR0eXBlX2luZm8KCiAgICAjIOWxleekuue8uuWkseexu+Wei+W5tuS4lOWPr+abtOaUuQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIGZpZWxkX25hKCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxlY3RlZF9kYXRhKCksIHBkLkRhdGFGcmFtZSk6CiAgICAgICAgICAgIGQxID0gc2VsZWN0ZWRfZGF0YSgpLmFwcGx5KGxhbWJkYSB5OmYie3JvdW5kKHkuaXNudWxsKCkuc3VtKCkvbGVuKHkpLDIpKjEwMH0lIikucmVzZXRfaW5kZXgoKQogICAgICAgICAgICBkMS5jb2x1bW5zID0gWyLlrZfmrrUiLCLnvLrlpLHmr5TkvosiXQogICAgICAgICAgICBkMSA9IGQxW2QxWyLnvLrlpLHmr5TkvosiXS5zdHIucmVwbGFjZSgiJSIsIiIpLm1hcChmbG9hdCk+MF0uc29ydF92YWx1ZXMoYnk9Iue8uuWkseavlOS+iyIsa2V5ID0gbGFtYmRhIHg6IHguc3RyLnJlcGxhY2UoIiUiLCIiKS5tYXAoZmxvYXQpLGFzY2VuZGluZz1GYWxzZSkKICAgICAgICAgICAgcmV0dXJuICB1aS5kaXYoCiAgICAgICAgICAgIHVpLnRhZ3MudGFibGUoCiAgICAgICAgICAgICAgICB1aS50YWdzLnRoZWFkKAogICAgICAgICAgICAgICAgICAgIHVpLnRhZ3MudHIoCiAgICAgICAgICAgICAgICAgICAgICAgICpbdWkudGFncy50aChpLHN0eWxlPXN0eWxlc1sidGgiXSkgZm9yIGkgaW4gZDEuY29sdW1uc10sCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnRhZ3MudGgoIuWkhOeQhue8uuWkseWAvCIsc3R5bGU9c3R5bGVzWyJ0aCJdKyJ3aWR0aDoxMDBweDsiKSPlkozkuIvpnaLkv53mjIHkuIDoh7QKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHVpLnRhZ3MudGJvZHkoCiAgICAgICAgICAgICAgICAqW3VpLnRhZ3MudHIoCiAgICAgICAgICAgICAgICAgICAgdWkudGFncy50ZChkMS5sb2NbaSwi5a2X5q61Il0sc3R5bGU9c3R5bGVzWyJ0ZCJdKSwKICAgICAgICAgICAgICAgICAgICB1aS50YWdzLnRkKGQxLmxvY1tpLCLnvLrlpLHmr5TkvosiXSxzdHlsZT1zdHlsZXNbInRkIl0pLAogICAgICAgICAgICAgICAgICAgIHVpLnRhZ3MudGQodWkuaW5wdXRfc2VsZWN0aXplKGQxLmxvY1tpLCLlrZfmrrUiXSsibmEiLE5vbmUsY2hvaWNlcz1bIiJdLHNlbGVjdGVkPSIiLHdpZHRoPSIxMDBweCIpLHN0eWxlPXN0eWxlc1sidWlfbm9sYWJlbF90ZCJdKQogICAgICAgICAgICAgICAgICAgICkgZm9yIGkgaW4gZDEuaW5kZXhdLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBzdHlsZSA9IHN0eWxlc1sidGFibGUiXQogICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc3R5bGUgPSBzdHlsZXNbInRhYmxlX2NvbnRhaW5lcl9kaXYiXS5mb3JtYXQoNTkwKQogICAgICAgICAgICApCiAgICAgICAgCiAgICAjIOS/ruaUueaVsOaNruexu+WeiyAgIAogICAgQHJlYWN0aXZlLkVmZmVjdAogICAgQHJlYWN0aXZlLmV2ZW50KGlucHV0LmNoYW5nZWR0eXBlKQogICAgZGVmIGNoYW5nZV9maWVsZF9kdHlwZSgpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VsZWN0ZWRfZGF0YSgpLCBwZC5EYXRhRnJhbWUpOgogICAgICAgICAgICBmb3IgY29sIGluIHNlbGVjdGVkX2RhdGEoKS5jb2x1bW5zOgogICAgICAgICAgICAgICAgIyDms6jmhI/kuIvpnaLkuI3og73lhplldmFsKCJpbnB1dC4iK2NvbCsiZHR5cGUoKSIpLGlucHV05Lya6buY6K6k5Li65YaF572u5Ye95pWwCiAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZF9kYXRhKClbY29sXS5kdHlwZXMgIT0gaW5wdXRbY29sKyJkdHlwZSJdKCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfZGF0YSgpLmxvY1s6LGNvbF0gPSBzZWxlY3RlZF9kYXRhKClbY29sXS5hc3R5cGUoaW5wdXRbY29sKyJkdHlwZSJdKCkpCiAgICAgICAgICAgIHVpLnVwZGF0ZV9zZWxlY3RpemUoImRtIixsYWJlbD0i57u05bqmIixjaG9pY2VzPWxpc3Qoc2VsZWN0ZWRfZGF0YSgpLnNlbGVjdF9kdHlwZXMoZXhjbHVkZT1bIm51bWJlciJdKS5jb2x1bW5zKSkKICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgidmwiLGxhYmVsPSLluqbph48iLGNob2ljZXM9bGlzdChzZWxlY3RlZF9kYXRhKCkuc2VsZWN0X2R0eXBlcyhpbmNsdWRlPVsibnVtYmVyIl0pLmNvbHVtbnMpKQoKICAgICMg5L+u5pS557y65aSx57G75Z6LCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgbWVyZ2VfZGF0YSAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyDliJvlu7rov57mjqXooajnmoR1aQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIGNyZWF0ZV9tZXJnZV91aSgpOgogICAgICAgIGlmIGdldF9kYXRhKCk6CiAgICAgICAgICAgIHJldHVybiB1aV90YWJsZSgKICAgICAgICAgICAgICAgICAgICAgICAgMiwzNDAsICAKICAgICAgICAgICAgICAgICAgICAgICAgWyLlt6bov57mjqXooagiICwgdWkuaW5wdXRfc2VsZWN0aXplKCJ0YWJsZV9sZWZ0IixOb25lLHdpZHRoPSIxNTBweCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNob2ljZXM9W2sgZm9yIGsgaW4gZ2V0X2RhdGEoKS5rZXlzKCldLHNlbGVjdGVkPU5vbmUpXSwKICAgICAgICAgICAgICAgICAgICAgICAgWyLlj7Pov57mjqXooagiICwgdWkuaW5wdXRfc2VsZWN0aXplKCJ0YWJsZV9yaWdodCIsTm9uZSx3aWR0aD0iMTUwcHgiLAogICAgICAgICAgICAgICAgICAgICAgICBjaG9pY2VzPVtrIGZvciBrIGluIGdldF9kYXRhKCkua2V5cygpXSxzZWxlY3RlZD1Ob25lKV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsi5bem6L+e5o6l5YiXIiAsIHVpLmlucHV0X3NlbGVjdGl6ZSgibGVmdF9vbl9jb2wiLE5vbmUsW10sbXVsdGlwbGU9VHJ1ZSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsi5Y+z6L+e5o6l5YiXIiAsIHVpLmlucHV0X3NlbGVjdGl6ZSgicmlnaHRfb25fY29sIixOb25lLFtdLG11bHRpcGxlPVRydWUsd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICAgICAgICAgICAgICBbIuW3puS/neeVmeWIlyIgLCB1aS5pbnB1dF9zZWxlY3RpemUoImxlZnRfc2F2ZV9jb2wiLE5vbmUsW10sbXVsdGlwbGU9VHJ1ZSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsi5Y+z5L+d55WZ5YiXIiAsIHVpLmlucHV0X3NlbGVjdGl6ZSgicmlnaHRfc2F2ZV9jb2wiLE5vbmUsW10sbXVsdGlwbGU9VHJ1ZSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsi6L+e5o6l5pa55byPIiAsIHVpLmlucHV0X3NlbGVjdGl6ZSgibWVyZ2Vfd2F5IixOb25lLHdpZHRoPSIxNTBweCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNob2ljZXM9WyJsZWZ0IiwicmlnaHQiLCJvdXRlciIsImlubmVyIiwiY3Jvc3MiXSldLAogICAgICAgICAgICAgICAgICAgICAgICBbIuihqOWQjSIgLCB1aS5pbnB1dF90ZXh0KCJtZXJnZV90YWJsZV9uYW1lIixOb25lLCIiLHdpZHRoPSIxNTBweCIpXSwKICAgICAgICAgICAgICAgICAgICAgICAgWyIiLHVpLmlucHV0X2FjdGlvbl9idXR0b24oImNvZF9tZXJnZV90YWJsZV9idXR0b24iLCLlop7liKDooajmoLwiLHN0eWxlPXN0eWxlc1siYnV0dG9uIl0sd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICAgICAgICAgICAgICBbIumAieaLqeWIoOmZpOihqOagvCIsdWkuaW5wdXRfc2VsZWN0aXplKCJkZWxldGVfbWVyZ2VfbmFtZSIsTm9uZSxbXSxtdWx0aXBsZT1UcnVlLHdpZHRoPSIxNTBweCIpXSwKICAgICAgICAgICAgICAgICAgICAgICAgKQoKICAgICMg5qC55o2u6KGo5pu05paw5a2X5q61CiAgICBAcmVhY3RpdmUuRWZmZWN0CiAgICBkZWYgXygpOgogICAgICAgIGlmIGlzaW5zdGFuY2UoZ2V0X2RhdGEoKSxkaWN0KToKICAgICAgICAgICAgaWYgKGJvb2woaW5wdXQudGFibGVfbGVmdCgpKSkmKGlucHV0LnRhYmxlX2xlZnQoKSBpbiBsaXN0KGdldF9kYXRhKCkua2V5cygpKSk6CiAgICAgICAgICAgICAgICB1aS51cGRhdGVfc2VsZWN0aXplKCJsZWZ0X29uX2NvbCIsbGFiZWw9Tm9uZSxjaG9pY2VzPWxpc3QoZ2V0X2RhdGEoKVtpbnB1dC50YWJsZV9sZWZ0KCldLmNvbHVtbnMpKQogICAgICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgibGVmdF9zYXZlX2NvbCIsbGFiZWw9Tm9uZSxjaG9pY2VzPWxpc3QoZ2V0X2RhdGEoKVtpbnB1dC50YWJsZV9sZWZ0KCldLmNvbHVtbnMpKQogICAgICAgICAgICBpZiAoYm9vbChpbnB1dC50YWJsZV9yaWdodCgpKSkmKGlucHV0LnRhYmxlX3JpZ2h0KCkgaW4gbGlzdChnZXRfZGF0YSgpLmtleXMoKSkpOgogICAgICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgicmlnaHRfb25fY29sIixsYWJlbD1Ob25lLGNob2ljZXM9bGlzdChnZXRfZGF0YSgpW2lucHV0LnRhYmxlX3JpZ2h0KCldLmNvbHVtbnMpKQogICAgICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgicmlnaHRfc2F2ZV9jb2wiLGxhYmVsPU5vbmUsY2hvaWNlcz1saXN0KGdldF9kYXRhKClbaW5wdXQudGFibGVfcmlnaHQoKV0uY29sdW1ucykpICAgCgogICAgIyDmm7TmlrBtZXJnZeaVsOaNrgogICAgQHJlYWN0aXZlLkVmZmVjdAogICAgQHJlYWN0aXZlLmV2ZW50KGlucHV0LmNvZF9tZXJnZV90YWJsZV9idXR0b24pCiAgICBkZWYgdXBkYXRlX21lcmdlX2RhdGEoKToKICAgICAgICBpZiBub3QgYm9vbChpbnB1dC5kZWxldGVfbWVyZ2VfbmFtZSgpKToKICAgICAgICAgICAgZGF0YSA9IHBkLm1lcmdlKAogICAgICAgICAgICAgICAgbGVmdD1nZXRfZGF0YSgpW2lucHV0LnRhYmxlX2xlZnQoKV0sCiAgICAgICAgICAgICAgICByaWdodD1nZXRfZGF0YSgpW2lucHV0LnRhYmxlX3JpZ2h0KCldLAogICAgICAgICAgICAgICAgb24gPSBOb25lIGlmIGxpc3QoaW5wdXQubGVmdF9vbl9jb2woKSkgIT0gbGlzdChpbnB1dC5yaWdodF9vbl9jb2woKSkgZWxzZSBsaXN0KGlucHV0LmxlZnRfb25fY29sKCkpLAogICAgICAgICAgICAgICAgbGVmdF9vbj1saXN0KGlucHV0LmxlZnRfb25fY29sKCkpIGlmIGxpc3QoaW5wdXQubGVmdF9vbl9jb2woKSkgIT0gbGlzdChpbnB1dC5yaWdodF9vbl9jb2woKSkgZWxzZSBOb25lLAogICAgICAgICAgICAgICAgcmlnaHRfb249bGlzdChpbnB1dC5yaWdodF9vbl9jb2woKSkgaWYgbGlzdChpbnB1dC5sZWZ0X29uX2NvbCgpKSAhPSBsaXN0KGlucHV0LnJpZ2h0X29uX2NvbCgpKSBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICBob3cgPSAgaW5wdXQubWVyZ2Vfd2F5KCksCiAgICAgICAgICAgIClbbGlzdChpbnB1dC5sZWZ0X3NhdmVfY29sKCkpK2xpc3QoaW5wdXQucmlnaHRfc2F2ZV9jb2woKSldCiAgICAgICAgICAgIG1kX3ZhbHVlID0gbWVyZ2VfZGF0YS5nZXQoKS5jb3B5KCkKICAgICAgICAgICAgbWRfdmFsdWUudXBkYXRlKHtpbnB1dC5tZXJnZV90YWJsZV9uYW1lKCk6ZGF0YX0pCiAgICAgICAgICAgIG1lcmdlX2RhdGEuc2V0KG1kX3ZhbHVlKQogICAgICAgICAgICB1aS51cGRhdGVfc2VsZWN0aXplKCJkZWxldGVfbWVyZ2VfbmFtZSIsbGFiZWw9Tm9uZSxjaG9pY2VzPWxpc3QobWVyZ2VfZGF0YS5nZXQoKS5rZXlzKCkpK1si5riF56m6Il0sc2VsZWN0ZWQ9Tm9uZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAi5riF56m6IiBpbiBpbnB1dC5kZWxldGVfbWVyZ2VfbmFtZSgpOgogICAgICAgICAgICAgICAgbWVyZ2VfZGF0YS5zZXQoe30pCiAgICAgICAgICAgICAgICB1aS51cGRhdGVfc2VsZWN0aXplKCJkZWxldGVfbWVyZ2VfbmFtZSIsbGFiZWw9Tm9uZSxjaG9pY2VzPVtdLHNlbGVjdGVkPU5vbmUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBtZF92YWx1ZSA9IG1lcmdlX2RhdGEuZ2V0KCkuY29weSgpCiAgICAgICAgICAgICAgICBmb3IgaSBpbiBpbnB1dC5kZWxldGVfbWVyZ2VfbmFtZSgpOgogICAgICAgICAgICAgICAgICAgIG1kX3ZhbHVlLnBvcChpKQogICAgICAgICAgICAgICAgbWVyZ2VfZGF0YS5zZXQobWRfdmFsdWUpCiAgICAgICAgICAgICAgICBpZiBtZXJnZV9kYXRhLmdldCgpOgogICAgICAgICAgICAgICAgICAgIHVpLnVwZGF0ZV9zZWxlY3RpemUoImRlbGV0ZV9tZXJnZV9uYW1lIixsYWJlbD1Ob25lLGNob2ljZXM9bGlzdChtZXJnZV9kYXRhKCkua2V5cygpKStbIua4heepuiJdLHNlbGVjdGVkPU5vbmUpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHVpLnVwZGF0ZV9zZWxlY3RpemUoImRlbGV0ZV9tZXJnZV9uYW1lIixsYWJlbD1Ob25lLGNob2ljZXM9W10sc2VsZWN0ZWQ9Tm9uZSkKICAgICAgICAgICAgICAgICAgICAKICAgICMg5Lul5qCH562+6aG15bGV56S6bWVyZ2VfZGF0YQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgIyBAcmVhY3RpdmUuZXZlbnQoaW5wdXQuY29kX21lcmdlX3RhYmxlX2J1dHRvbikKICAgIGRlZiBzaG93X21lcmdlX2RhdGEoKToKICAgICAgICBpZiBtZXJnZV9kYXRhLmdldCgpOgogICAgICAgICAgICBkcyA9IG1lcmdlX2RhdGEuZ2V0KCkKICAgICAgICAgICAgcmV0dXJuIHVpLm5hdnNldF90YWIoKlt1aS5uYXYoayxkZl90b191aV90YWJsZSh2LmhlYWQoMTAwKSwzMDApKSBmb3Igayx2IGluIGRzLml0ZW1zKCldKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcGl2b3RfdGFibGUgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjIOWIm+W7unBpdm90X3RhYmxl55qEdWkKICAgIEBvdXRwdXQKICAgIEByZW5kZXIudWkKICAgIGRlZiBjcmVhdGVfcGl2b3RfdWkoKToKICAgICAgICByZXR1cm4gdWlfdGFibGUoMiwzNDAsCiAgICAgICAgICAgIFsi6YCJ5oup6KGo5qC8Iix1aS5pbnB1dF9zZWxlY3RpemUoInNlbGVjdF9tZXJnZV9hbmRfZGF0YV90YWJsZSIsTm9uZSwKICAgICAgICAgICAgICAgIGNob2ljZXMgPSBsaXN0KGdldF9kYXRhKCkua2V5cygpIGlmIGdldF9kYXRhKCkgZWxzZSBbXSkgICsgbGlzdChtZXJnZV9kYXRhLmdldCgpLmtleXMoKSBpZiBtZXJnZV9kYXRhLmdldCgpIGVsc2UgW10pLHdpZHRoPSIxNTBweCIpXSwKICAgICAgICAgICAgWyJpbmRleCIsdWkuaW5wdXRfc2VsZWN0aXplKCJwaXZvdF9pbmRleF9jb2wiLE5vbmUsbXVsdGlwbGU9VHJ1ZSwKICAgICAgICAgICAgICAgIGNob2ljZXM9W10sd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICBbImNvbHVtbiIsdWkuaW5wdXRfc2VsZWN0aXplKCJwaXZvdF9jb2x1bW5fY29sIixOb25lLFtdLG11bHRpcGxlPVRydWUsd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICBbIuWAvCIsdWkuaW5wdXRfc2VsZWN0aXplKCJwaXZvdF92YWx1ZV9jb2wiLE5vbmUsW10sbXVsdGlwbGU9VHJ1ZSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgIFsi5Ye95pWwIix1aS5pbnB1dF9zZWxlY3RpemUoInBpdm90X3ZhbHVlX2Z1bmMiLE5vbmUsWyJzdW0iLCJtZWFuIiwibWF4IiwibWluIiwiY291bnQiXSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICMgWyLloavlhYXnvLrlpLHlgLwiLHVpLmlucHV0X3RleHQoImZpbGxfcGl2b3RfbmEiLE5vbmUsTm9uZSldICwKICAgICAgICAgICAgWyLooajlkI0iICwgdWkuaW5wdXRfdGV4dCgicGl2b3RfdGFibGVfbmFtZSIsTm9uZSwiIix3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgIFsi6YCJ5oup5Yig6Zmk6KGo5qC8Iix1aS5pbnB1dF9zZWxlY3RpemUoImRlbGV0ZV9waXZvdF9uYW1lIixOb25lLFtdLG11bHRpcGxlPVRydWUsd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICBbIiIsdWkuaW5wdXRfYWN0aW9uX2J1dHRvbigiY29kX3Bpdm90X3RhYmxlX2J1dHRvbiIsIuWinuWIoOihqOagvCIsc3R5bGU9c3R5bGVzWyJidXR0b24iXSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgIAogICAgIyDmoLnmja7ooajmoLzmm7TmlrDlrZfmrrUKICAgIEByZWFjdGl2ZS5FZmZlY3QoKQogICAgZGVmIHVwZGF0ZV9waXZvdF91aSgpOgogICAgICAgIGlmIGlucHV0LnNlbGVjdF9tZXJnZV9hbmRfZGF0YV90YWJsZSgpOgogICAgICAgICAgICBjID0gbGlzdChnZXRfZGF0YSgpW2lucHV0LnNlbGVjdF9tZXJnZV9hbmRfZGF0YV90YWJsZSgpXS5jb2x1bW5zKSBpZiBpbnB1dC5zZWxlY3RfbWVyZ2VfYW5kX2RhdGFfdGFibGUoKSBpbiBsaXN0KGdldF9kYXRhKCkua2V5cygpKSBlbHNlIGxpc3QobWVyZ2VfZGF0YS5nZXQoKVtpbnB1dC5zZWxlY3RfbWVyZ2VfYW5kX2RhdGFfdGFibGUoKV0uY29sdW1ucykKICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgicGl2b3RfaW5kZXhfY29sIixsYWJlbD1Ob25lLGNob2ljZXM9YykKICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgicGl2b3RfY29sdW1uX2NvbCIsbGFiZWw9Tm9uZSxjaG9pY2VzPWMpCiAgICAgICAgICAgIHVpLnVwZGF0ZV9zZWxlY3RpemUoInBpdm90X3ZhbHVlX2NvbCIsbGFiZWw9Tm9uZSxjaG9pY2VzPWMpCgogICAgIyDmm7TmlrBwaXZvdF9kYXRhCiAgICBAcmVhY3RpdmUuRWZmZWN0CiAgICBAcmVhY3RpdmUuZXZlbnQoaW5wdXQuY29kX3Bpdm90X3RhYmxlX2J1dHRvbikKICAgIGRlZiB1cGRhdGVfcGl2b3RfZGF0YSgpOgogICAgICAgIGlmIG5vdCBib29sKGlucHV0LmRlbGV0ZV9waXZvdF9uYW1lKCkpOgogICAgICAgICAgICBpZiBpbnB1dC5waXZvdF92YWx1ZV9mdW5jKCk6CiAgICAgICAgICAgICAgICBmdW5jX21hcCA9IHsic3VtIjpzdW0sIm1lYW4iOmxhbWJkYSB4OiByb3VuZChzdW0oeCkvbGVuKHgpLDIpLCJtYXgiOm1heCwibWluIjptaW4sImNvdW50IjpsZW59CiAgICAgICAgICAgICAgICBkYXRhID0gcGQucGl2b3RfdGFibGUoCiAgICAgICAgICAgICAgICAgICAgbWVyZ2VfZGF0YS5nZXQoKVtpbnB1dC5zZWxlY3RfbWVyZ2VfYW5kX2RhdGFfdGFibGUoKV0gaWYgaW5wdXQuc2VsZWN0X21lcmdlX2FuZF9kYXRhX3RhYmxlKCkgaW4gbGlzdChtZXJnZV9kYXRhLmdldCgpLmtleXMoKSkgZWxzZSBnZXRfZGF0YSgpW2lucHV0LnNlbGVjdF9tZXJnZV9hbmRfZGF0YV90YWJsZSgpXSwKICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGxpc3QoaW5wdXQucGl2b3RfaW5kZXhfY29sKCkpLAogICAgICAgICAgICAgICAgICAgIGNvbHVtbnMgPSBsaXN0KGlucHV0LnBpdm90X2NvbHVtbl9jb2woKSksCiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID1saXN0KGlucHV0LnBpdm90X3ZhbHVlX2NvbCgpKSwKICAgICAgICAgICAgICAgICAgICBhZ2dmdW5jPSBmdW5jX21hcFtpbnB1dC5waXZvdF92YWx1ZV9mdW5jKCldCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsc2UgOgogICAgICAgICAgICAgICAgZGF0YSA9IHBkLnBpdm90KAogICAgICAgICAgICAgICAgICAgIG1lcmdlX2RhdGEuZ2V0KClbaW5wdXQuc2VsZWN0X21lcmdlX2FuZF9kYXRhX3RhYmxlKCldIGlmIGlucHV0LnNlbGVjdF9tZXJnZV9hbmRfZGF0YV90YWJsZSgpIGluIGxpc3QobWVyZ2VfZGF0YS5nZXQoKS5rZXlzKCkpIGVsc2UgZ2V0X2RhdGEoKVtpbnB1dC5zZWxlY3RfbWVyZ2VfYW5kX2RhdGFfdGFibGUoKV0sCiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBsaXN0KGlucHV0LnBpdm90X2luZGV4X2NvbCgpKSwKICAgICAgICAgICAgICAgICAgICBjb2x1bW5zID0gbGlzdChpbnB1dC5waXZvdF9jb2x1bW5fY29sKCkpLAogICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9bGlzdChpbnB1dC5waXZvdF92YWx1ZV9jb2woKSksCiAgICAgICAgICAgICAgICApICAgIAogICAgICAgICAgICBwaXZvdF92YWx1ZSA9IHBpdm90X2RhdGEuZ2V0KCkuY29weSgpCiAgICAgICAgICAgIHBpdm90X3ZhbHVlLnVwZGF0ZSh7aW5wdXQucGl2b3RfdGFibGVfbmFtZSgpOmRhdGF9KQogICAgICAgICAgICBwaXZvdF9kYXRhLnNldChwaXZvdF92YWx1ZSkKICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgiZGVsZXRlX3Bpdm90X25hbWUiLGxhYmVsPU5vbmUsY2hvaWNlcz1saXN0KHBpdm90X2RhdGEuZ2V0KCkua2V5cygpKStbIua4heepuiJdLHNlbGVjdGVkPU5vbmUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgIua4heepuiIgaW4gaW5wdXQuZGVsZXRlX3Bpdm90X25hbWUoKToKICAgICAgICAgICAgICAgIHBpdm90X2RhdGEuc2V0KHt9KQogICAgICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgiZGVsZXRlX3Bpdm90X25hbWUiLGxhYmVsPU5vbmUsY2hvaWNlcz1bXSxzZWxlY3RlZD1Ob25lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcGl2b3RfdmFsdWUgPSBwaXZvdF9kYXRhLmdldCgpLmNvcHkoKQogICAgICAgICAgICAgICAgZm9yIGkgaW4gaW5wdXQuZGVsZXRlX3Bpdm90X25hbWUoKToKICAgICAgICAgICAgICAgICAgICBwaXZvdF92YWx1ZS5wb3AoaSkKICAgICAgICAgICAgICAgIHBpdm90X2RhdGEuc2V0KHBpdm90X3ZhbHVlKQogICAgICAgICAgICAgICAgaWYgcGl2b3RfZGF0YS5nZXQoKToKICAgICAgICAgICAgICAgICAgICB1aS51cGRhdGVfc2VsZWN0aXplKCJkZWxldGVfcGl2b3RfbmFtZSIsbGFiZWw9Tm9uZSxjaG9pY2VzPWxpc3QocGl2b3RfZGF0YSgpLmtleXMoKSkrWyLmuIXnqboiXSxzZWxlY3RlZD1Ob25lKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB1aS51cGRhdGVfc2VsZWN0aXplKCJkZWxldGVfcGl2b3RfbmFtZSIsbGFiZWw9Tm9uZSxjaG9pY2VzPVtdLHNlbGVjdGVkPU5vbmUpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgIyDlsZXnpLpwaXZvdF90YWJsZQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIHNob3dfcGl2b3RfZGF0YSgpOgogICAgICAgIGlmIHBpdm90X2RhdGEuZ2V0KCk6CiAgICAgICAgICAgIGRzID0gcGl2b3RfZGF0YS5nZXQoKQogICAgICAgICAgICByZXR1cm4gdWkubmF2c2V0X3RhYigqW3VpLm5hdihrLGRmX3RvX3VpX3RhYmxlKHYuaGVhZCgxMDApLDMwMCxUcnVlKSkgZm9yIGssdiBpbiBkcy5pdGVtcygpXSkKICAgIAogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBncm91cGJ5X2RhdGEgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyDliJvlu7rov57mjqXooajnmoR1aQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIGNyZWF0ZV9ncm91cGJ5X3VpKCk6CiAgICAgICAgcmV0dXJuIHVpX3RhYmxlKAogICAgICAgICAgICAgICAgICAgIDIsMzQwLCAgCiAgICAgICAgICAgICAgICAgICAgWyLpgInmi6nooajmoLwiLHVpLmlucHV0X3NlbGVjdGl6ZSgic21hZHQiLE5vbmUsCiAgICAgICAgICAgICAgICAgICAgY2hvaWNlcyA9bGlzdChnZXRfZGF0YSgpLmtleXMoKSBpZiBnZXRfZGF0YSgpIGVsc2UgW10pICArIGxpc3QobWVyZ2VfZGF0YS5nZXQoKS5rZXlzKCkgaWYgbWVyZ2VfZGF0YS5nZXQoKSBlbHNlIFtdKSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgWyLliIbnu4TliJciLHVpLmlucHV0X3NlbGVjdGl6ZSgiZ3JvdXBieV9pbmRleF9jb2wiLE5vbmUsbXVsdGlwbGU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgY2hvaWNlcz1bXSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgWyLkv53nlZnliJciLHVpLmlucHV0X3NlbGVjdGl6ZSgiZ3JvdXBieV9jb2x1bW5fY29sIixOb25lLFtdLG11bHRpcGxlPVRydWUsd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICAgICAgICAgIFsi5Ye95pWw6YCJ6aG5Iix1aS5pbnB1dF9zZWxlY3RpemUoImdyb3VwYnlfZnVuY19raW5kIixOb25lLFsi6KGMIiwi5YiXIiwiZ3JvdXAiXSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgWyLlh73mlbAiLHVpLmlucHV0X3NlbGVjdGl6ZSgiZ3JvdXBieV9mdW5jX29wdGlvbiIsTm9uZSxbInN1bSIsIm1lYW4iLCJtYXgiLCJtaW4iLCJjb3VudCJdLHdpZHRoPSIxNTBweCIpXSwKICAgICAgICAgICAgICAgICAgICBbIuihqOWQjSIgLCB1aS5pbnB1dF90ZXh0KCJncm91cGJ5X3RhYmxlX25hbWUiLE5vbmUsIiIsd2lkdGg9IjE1MHB4IildLAogICAgICAgICAgICAgICAgICAgIFsi6YCJ5oup5Yig6Zmk6KGo5qC8Iix1aS5pbnB1dF9zZWxlY3RpemUoImRlbGV0ZV9ncm91cGJ5X25hbWUiLE5vbmUsW10sbXVsdGlwbGU9VHJ1ZSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgWyIiLHVpLmlucHV0X2FjdGlvbl9idXR0b24oImNvZF9ncm91cGJ5X3RhYmxlX2J1dHRvbiIsIuWinuWIoOihqOagvCIsc3R5bGU9c3R5bGVzWyJidXR0b24iXSx3aWR0aD0iMTUwcHgiKV0sCiAgICAgICAgICAgICAgICAgICAgKQoKICAgICMg5qC55o2u6KGo5pu05paw5a2X5q61CiAgICBAcmVhY3RpdmUuRWZmZWN0CiAgICBkZWYgdXBkYXRlX2dyb3VwYnlfdWkoKToKICAgICAgICBpZiBpbnB1dC5zbWFkdCgpOgogICAgICAgICAgICBjID0gbGlzdChnZXRfZGF0YSgpW2lucHV0LnNtYWR0KCldLmNvbHVtbnMpIGlmIGlucHV0LnNtYWR0KCkgaW4gbGlzdChnZXRfZGF0YSgpLmtleXMoKSkgZWxzZSBsaXN0KG1lcmdlX2RhdGEuZ2V0KClbaW5wdXQuc21hZHQoKV0uY29sdW1ucykKICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgiZ3JvdXBieV9pbmRleF9jb2wiLGxhYmVsPU5vbmUsY2hvaWNlcz1jKQogICAgICAgICAgICB1aS51cGRhdGVfc2VsZWN0aXplKCJncm91cGJ5X2NvbHVtbl9jb2wiLGxhYmVsPU5vbmUsY2hvaWNlcz1jKQoKICAgICMg5pu05pawZ3JvdXBieV9kYXRh5pWw5o2uCiAgICBAcmVhY3RpdmUuRWZmZWN0CiAgICBAcmVhY3RpdmUuZXZlbnQoaW5wdXQuY29kX2dyb3VwYnlfdGFibGVfYnV0dG9uKQogICAgZGVmIHVwZGF0ZV9ncm91cGJ5X2RhdGEoKToKICAgICAgICBpZiBub3QgYm9vbChpbnB1dC5kZWxldGVfZ3JvdXBieV9uYW1lKCkpOgogICAgICAgICAgICBmdW5jX21hcCA9IHsic3VtIjpucC5zdW0sIm1lYW4iOm5wLm1lYW4sIm1lZGlhbiI6bnAubWVkaWFuLCJtYXgiOm5wLmFtYXgsIm1pbiI6bnAuYW1pbiwiY291bnQiOmxhbWJkYSB4Omxlbih4KSBpZiBsZW4oeC5zaGFwZSk9PTEgZWxzZSB4LnNoYXBlWzBdKnguc2hhcGVbMV19CiAgICAgICAgICAgIGRhdGEgPSBtZXJnZV9kYXRhLmdldCgpW2lucHV0LnNtYWR0KCldIGlmIGlucHV0LnNtYWR0KCkgaW4gbGlzdChtZXJnZV9kYXRhLmdldCgpLmtleXMoKSkgZWxzZSBnZXRfZGF0YSgpW2lucHV0LnNtYWR0KCldCiAgICAgICAgICAgIG5ld19kYXRhID0gZGF0YS5ncm91cGJ5KGxpc3QoaW5wdXQuZ3JvdXBieV9pbmRleF9jb2woKSkpW2xpc3QoaW5wdXQuZ3JvdXBieV9jb2x1bW5fY29sKCkpXQogICAgICAgICAgICAj5LiL6Z2i6YO95piv5Lul5Y2V5Liq5Ye95pWw5Li65Yik5pat5qCH5YeGCiAgICAgICAgICAgIGlmIGlucHV0Lmdyb3VwYnlfZnVuY19raW5kKCkgPT0gIuihjCI6CiAgICAgICAgICAgICAgICBuZXdfZGF0YTIgPSBuZXdfZGF0YS5hcHBseShmdW5jX21hcFtpbnB1dC5ncm91cGJ5X2Z1bmNfb3B0aW9uKCldLGF4aXM9MSkKICAgICAgICAgICAgICAgIG5ld19kYXRhMi5jb2x1bW5zID0gW2lucHV0Lmdyb3VwYnlfZnVuY19vcHRpb24oKV0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGlucHV0Lmdyb3VwYnlfZnVuY19raW5kKCkgPT0gIuWIlyI6CiAgICAgICAgICAgICAgICAgICAgbmV3X2RhdGEyID0gbmV3X2RhdGEuYWdnKGZ1bmNfbWFwW2lucHV0Lmdyb3VwYnlfZnVuY19vcHRpb24oKV0pCiAgICAgICAgICAgICAgICAjIOi/mOaciWdyb3Vw5rKh5pyJ5YaZCiAgICAgICAgICAgIGdyb3VwYnlfdmFsdWUgPSBncm91cGJ5X2RhdGEuZ2V0KCkuY29weSgpCiAgICAgICAgICAgIGdyb3VwYnlfdmFsdWUudXBkYXRlKHtpbnB1dC5ncm91cGJ5X3RhYmxlX25hbWUoKTpuZXdfZGF0YTJ9KQogICAgICAgICAgICBncm91cGJ5X2RhdGEuc2V0KGdyb3VwYnlfdmFsdWUpCiAgICAgICAgICAgIHVpLnVwZGF0ZV9zZWxlY3RpemUoImRlbGV0ZV9ncm91cGJ5X25hbWUiLGxhYmVsPU5vbmUsY2hvaWNlcz1saXN0KGdyb3VwYnlfZGF0YS5nZXQoKS5rZXlzKCkpK1si5riF56m6Il0sc2VsZWN0ZWQ9Tm9uZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAi5riF56m6IiBpbiBpbnB1dC5kZWxldGVfZ3JvdXBieV9uYW1lKCk6CiAgICAgICAgICAgICAgICBncm91cGJ5X2RhdGEuc2V0KHt9KQogICAgICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgiZGVsZXRlX2dyb3VwYnlfbmFtZSIsbGFiZWw9Tm9uZSxjaG9pY2VzPVtdLHNlbGVjdGVkPU5vbmUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBncm91cGJ5X3ZhbHVlID0gZ3JvdXBieV9kYXRhLmdldCgpLmNvcHkoKQogICAgICAgICAgICAgICAgZm9yIGkgaW4gaW5wdXQuZGVsZXRlX2dyb3VwYnlfbmFtZSgpOgogICAgICAgICAgICAgICAgICAgIGdyb3VwYnlfdmFsdWUucG9wKGkpCiAgICAgICAgICAgICAgICBncm91cGJ5X2RhdGEuc2V0KGdyb3VwYnlfdmFsdWUpCiAgICAgICAgICAgICAgICBpZiBncm91cGJ5X2RhdGEuZ2V0KCk6CiAgICAgICAgICAgICAgICAgICAgdWkudXBkYXRlX3NlbGVjdGl6ZSgiZGVsZXRlX2dyb3VwYnlfbmFtZSIsbGFiZWw9Tm9uZSxjaG9pY2VzPWxpc3QoZ3JvdXBieV9kYXRhKCkua2V5cygpKStbIua4heepuiJdLHNlbGVjdGVkPU5vbmUpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHVpLnVwZGF0ZV9zZWxlY3RpemUoImRlbGV0ZV9ncm91cGJ5X25hbWUiLGxhYmVsPU5vbmUsY2hvaWNlcz1bXSxzZWxlY3RlZD1Ob25lKQogICAgICAgICAgICAgICAgICAgIAogICAgIyDku6XmoIfnrb7pobXlsZXnpLpncm91cGJ5X2RhdGEKICAgIEBvdXRwdXQKICAgIEByZW5kZXIudWkKICAgIGRlZiBzaG93X2dyb3VwYnlfZGF0YSgpOgogICAgICAgIGlmIGdyb3VwYnlfZGF0YS5nZXQoKToKICAgICAgICAgICAgZHMgPSBncm91cGJ5X2RhdGEuZ2V0KCkKICAgICAgICAgICAgcmV0dXJuIHVpLm5hdnNldF90YWIoKlt1aS5uYXYoayxkZl90b191aV90YWJsZSh2LmhlYWQoMTAwKSwzMDAsVHJ1ZSkpIGZvciBrLHYgaW4gZHMuaXRlbXMoKV0pCiAgICAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIGdyYXBoICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICPliJvlu7pncmFwaF91aQogICAgQG91dHB1dAogICAgQHJlbmRlci51aQogICAgZGVmIGNyZWF0ZV9ncmFwaF91aSgpOgogICAgICAgIHJldHVybiB1aS5kaXYoCiAgICAgICAgdWkuaW5wdXRfc2VsZWN0aXplKCJncmFwaF90YWJsZSIsIumAieaLqeihqOagvCIsY2hvaWNlcz1saXN0KGdyb3VwYnlfZGF0YS5nZXQoKS5rZXlzKCkpLHdpZHRoPSIxNTBweCIpLAogICAgICAgIHVpLmlucHV0X2FjdGlvbl9idXR0b24oImNvZF9ncmFwaF9idXR0b24iLCLnlJ/miJDlm77niYciLHdpZHRoPSIxNTBweCIpCiAgICAgICAgKQogICAgCiAgICAjIOWxleekuuWbvuihqAogICAgQG91dHB1dAogICAgQHJlbmRlci5wbG90CiAgICBAcmVhY3RpdmUuZXZlbnQoaW5wdXQuY29kX2dyYXBoX2J1dHRvbikgICAgCiAgICBkZWYgc2hvd19ncmFwaCgpOgogICAgICAgIGlmIGlucHV0LmdyYXBoX3RhYmxlKCk6CiAgICAgICAgICAgIGZpZyxheCA9IHBsdC5zdWJwbG90cygxLDEpCiAgICAgICAgICAgIGdyb3VwYnlfZGF0YS5nZXQoKVtpbnB1dC5ncmFwaF90YWJsZSgpXS5wbG90KAogICAgICAgICAgICAgICAga2luZD0iYmFyIiwKICAgICAgICAgICAgICAgIGF4ID0gYXgKICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4gZmlnCiAgICAKICAgICMg5Yib5bu6cGl2b3RfdGFibGUoKQoKYXBwID0gQXBwKGFwcF91aSxzZXJ2ZXIpCg==", "type": "binary"}, {"name": "requirements.txt", "content": "matplotlib\nfsspec==2023.4.0", "type": "text"}]